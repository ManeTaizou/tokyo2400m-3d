<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>東京競馬場 2400m 3D</title>
  <style>html,body{margin:0;height:100%;overflow:hidden;background:#111}</style>
</head>
<body>
<div id="c"></div>
<script type="module">
import * as THREE from "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js";
import {OrbitControls} from "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/controls/OrbitControls.js";

const w=window.innerWidth,h=window.innerHeight;
const scene=new THREE.Scene();scene.background=new THREE.Color(0x111111);
const cam=new THREE.PerspectiveCamera(55,w/h,0.1,5000);cam.position.set(0,800,1200);
const ren=new THREE.WebGLRenderer({antialias:true});ren.setSize(w,h);document.body.appendChild(ren.domElement);
const ctl=new OrbitControls(cam,ren.domElement);ctl.enableDamping=true;

scene.add(new THREE.AmbientLight(0xffffff,0.7));
const dir=new THREE.DirectionalLight(0xffffff,0.8);dir.position.set(200,400,300);scene.add(dir);

/* ------ コース（簡易オーバル） ------ */
const r=190, st=526;          // 半径と直線長 (概算, 単位px)
const pts=[],seg=50;
for(let i=0;i<=seg;i++){const th=Math.PI/2+Math.PI/2*i/seg;pts.push(new THREE.Vector3(-st/2+r*Math.cos(th),0,r*Math.sin(th)));}
pts.push(new THREE.Vector3(st/2,0,r));
for(let i=0;i<=seg;i++){const th=Math.PI/2+Math.PI/2*i/seg;pts.push(new THREE.Vector3(st/2+r*Math.cos(-th),0,r*Math.sin(-th)));}
pts.push(new THREE.Vector3(-st/2,0,-r));

const path=new THREE.CatmullRomCurve3(pts,true);
const track=new THREE.Mesh(
  new THREE.TubeGeometry(path,300,12,16,true),
  new THREE.MeshStandardMaterial({color:0x1c7a1c})
);
scene.add(track);

/* ------ ロゴを裏面に ------ */
const tex=new THREE.TextureLoader().load("https://placehold.co/256x256?text=WIN5-LABO");
const egg=new THREE.Mesh(new THREE.PlaneGeometry(120,120),
  new THREE.MeshBasicMaterial({map:tex,transparent:true,side:THREE.DoubleSide}));
egg.rotation.x=Math.PI;egg.position.set(0,-50,0);scene.add(egg);

/* ------ ループ ------ */
window.addEventListener("resize",()=>{const w=innerWidth,h=innerHeight;cam.aspect=w/h;cam.updateProjectionMatrix();ren.setSize(w,h);});
(function loop(){requestAnimationFrame(loop);ctl.update();ren.render(scene,cam);})();
</script>
</body>
</html>
